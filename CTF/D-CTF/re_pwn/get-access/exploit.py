#!/usr/bin/env python 

from pwn import *

def recv_response(p):
    r = p.recv()
    print "[+] Response: " + r 
    return r 

def extract_flag(extracted_hex):
    message = list(extracted_hex.decode('hex'))
    flag = []

    n = len(message)
    for i in range(0, n, 4):
        if i + 3 < n:
            flag.append(message[i + 3])

        if i + 2 < n:
            flag.append(message[i + 2])

        if i + 1 < n:
            flag.append(message[i + 1])

        flag.append(message[i])

    print "[+] Raw password: " + extracted_hex
    print "[+] Decoded password: " + ''.join(flag) + " (Ignore QQ)"
    return 0 

p = remote("206.81.24.129", 1337)

extract_flag("5f245151533148544854533133573433334d305353733450445230775952304643445530303246545f3931")

username = "DCTF2019" 
recv_response(p)
p.sendline(username)

password = "$_TH1S1STH34W3S0M3P4sSw0RDF0RY0UDCTF2019_"
recv_response(p)
p.sendline(password)

p.interactive()
